{% block field_row %}
    {% spaceless %}
        <div class="form_row">
            {{ form_label(form) }}
            {{ form_errors(form) }}
            {{ form_widget(form) }}
        </div>
    {% endspaceless %}
{% endblock field_row %}


{% block date_widget %}
    {% spaceless %}
        {{ block('form_widget_simple') }}
        <script>
            $(function() {
              $( "#{{ id }}" ).datepicker({
                  dateFormat: '{{ dateFormat }}',
                });
              $.datepicker.setDefaults($.datepicker.regional['{{locale}}']);
            });
        </script>
    {% endspaceless %}
{% endblock date_widget %}


{% block date_range_row %}
    {% spaceless %}
        <div class="form_row">
            {{ form_label(form) }}
            {{ form_errors(form) }}
            {{ form_widget(form) }}
        </div>
    {% endspaceless %}
{% endblock date_range_row %}


{% block ajax_autocomplete_widget %}

    {% stylesheets '@NitraThemeBundle/Resources/public/css/jquery.autocomplete.css' %}
            <link rel="stylesheet" href="{{ asset_url }}" />
    {% endstylesheets %}

    {% javascripts '@NitraThemeBundle/Resources/public/js/jquery.autocomplete.js' %}
            <script src="{{ asset_url }}"></script>
    {% endjavascripts %}

    {% spaceless %}

        <div class="form_row">

            {{ form_errors(form) }}

            {{ form_widget(form.name) }}
            {{ form_widget(form.id) }}
        </div>


        <script type="text/javascript">

          (function(){
                $('#{{ form.name.vars.id }}').autocomplete('{{ path (autocompleteActionRouting) }}', {
                    minChars: {{ minChars }},
                    delimiter: /(,|;)\s*/,
                    maxHeight: {{ maxHeight }},
                    width: {{ width }},
                    zIndex: 9999,
                    deferRequestBy: {{ deferRequestBy }},
                    dataType: "json",
                    extraParams: {
                        {{ extraParamsString | raw }}
                    },

                    onItemSelect: function(row) {


                            {# Для использования json данных необходимо в Контроллере,
                               который возвращает данные для выпадающего списка возвращать данные в следующем формате

$Строка_отображения_во_время_набора_с_клавиатуры . "|" . $Строка_которая_подставиться_при_выборе_из_списка . "|" . $Идентификатор . '|' . json_encode($json-данные_для_обработки_в_скрипте)

                            Сюда данные прийдут в переменной row.extra[2]
                            Для превращения их в Javascript-массив выполняем следующее

                            value1 = eval('('+row.extra[2]+')');

                            После чего в value1 у нас javascript-массив, к елементам которго можно обращатся value1.ключ_в_массиве

                            #}

                            $('#{{ form.name.vars.id }}').val(row.extra[0]);
                            $('#{{ form.id.vars.id }}').val(row.extra[1]);

                            {{ afterItemSelectJavascript | raw }}
                        }

                }).change(function(){
                                        if (!$.trim(this.value)) {
                                            $('#{{ form.id.vars.id }}').val('').change();
                                        }

                                    });
       })();
        </script>

    {% endspaceless %}


{% endblock ajax_autocomplete_widget %}
